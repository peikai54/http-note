## 域名与 DNS 的二三事

每一台电脑都有一个独特的 ipv4 地址和 ipv6 地址，这个地址就是电脑在网络世界里的唯一 id，是他们的身份标识。但在日常网络中，直接使用 IP 地址进行通信并不方便，因此我们平时访问网络世界，使用的并非 ip 地址而是域名。而 DNS 解析指的就是将域名解析成正确的 ip 地址。

### 如何快速从域名中获取到 ip 地址

dns 实际上是域名和 ip 之间的一个映射关系，每个域名对应一个 ip。但计算机的数量早就是一个天文数字了，如果每次域名解析都向域名服务器发起请求，获取对应的 ip 地址，那 DNS 解析会相当耗时间。解决这个问题最有效的办法自然是缓存。

很多浏览器会进行一层 DNS 缓存，操作系统也会进行 DNS 缓存。因此浏览器拿到域名时，首先会访问浏览器及操作系统上的 DNS 缓存，看以前有没有缓存过这个域名的 ip 地址，如果拿到 ip 地址以后便可以直接使用。

如果缓存里没有这个域名，浏览器会向域名服务器获取该域名绑定的 IP 地址。域名服务器本身则是一个树状的分布式结构。如果要查找一个域名 test.me.com ， 我们会先找到 com 的根域名服务器，再从 com 的下级子节点中寻找顶级域名服务器 me, 然后从 me 往下寻找权威域名服务器 test。这种树状域名管理方式大大提高了查询的效率。

![avatar](https://for-wp.obs.cn-south-1.myhuaweicloud.com:443/6b020454987543efdd1cf6ddec784bf2%20%281%29.webp?AccessKeyId=0FBSS4ODLZBACMCPJGBG&Expires=1710697294&Signature=RSk42SOyToRmRDyE6IvU6n4XaVI%3D)

### 域名的一些运用

1. 利用 DNS 解析做到应用版本的回滚或重定向。

假设我们现在有一个域名 a.b.c，指向了 ip 1.2.3.4，现在我们要上线一个新版本。我们先将这个版本部署到 5.6.7.8，然后将域名指向 5.6.7.8 这个新版本，完成线上的测试验证和验收以后发，再把 5.6.7.8 上的版本部署到 1.2.3.4 上。这样的好处是，如果新版本除了问题，可以马上切换到旧版本上完成回滚。

2. 负载均衡

域名解析可以返回多个 ip 地址，然后不同服务器通过轮询或按照权重分担不同的流量，实现负载均衡。
